<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>购买时间</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="stylesheet" href="http://g.alicdn.com/msui/sm/0.6.2/css/sm.min.css">
    <link rel="stylesheet" href="http://g.alicdn.com/msui/sm/0.6.2/css/sm-extend.min.css">
    <link rel="stylesheet" href="../css/index.css">

</head>
<style>

</style>
<body>
<div class="page-group">
    <!-- 单个page ,第一个.page默认被展示-->
    <div class="page" id="router2">
        <!-- 标题栏 -->
        <header class="bar bar-nav">
            <a class="button button-link button-nav pull-left back ">
                <span class="icon icon-left"></span>
            </a>
            <h1 class="title">选择购买时间</h1>
        </header>

        <!-- 这里是页面内容区 -->
        <div class="content">
            <div class="list-block cards-list">
                <div class="card time-card">
                    <div class="card-header time-address">科技大厦</div>
                    <div class="card-content">
                            <div class="item-content time-list">
                                <div class="item-inner item-list">
                                    <div class="item-title label">起始日期</div>
                                    <div class="item-input dateselect">
                                        <input type="text"  placeholder="选择日期" class="date datetime-picker"/>
                                    </div>
                                </div>
                            </div>
                            <div class="item-content time-list">
                                <div class="item-inner">
                                    <div class="item-title label">天数</div>
                                    <div class="item-input ">
                                        <div  class="item-link item-content" style="border-bottom: 0">
                                            <div class="item-inner item-list item-daynum" >
                                                <div class="item-title">
                                                    <input type="text" class='picker' placeholder="" value="1天"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-header" style="font-size: 0.7rem;background-color: #f7f7f8">发布时段（以小时为单位）</div>
                            <div class="item-content time-list">
                                <div class="item-inner">
                                    <div class="item-title label">日期</div>
                                    <div class="item-input dayselect">
                                        <div  class="item-link item-content" style="border-bottom: 0">
                                            <div class="item-inner item-list item-daynum">

                                                    <select>
                                                        <option>每天</option>
                                                    </select>
                                                    <!--<input type="text"  id="pickerAllDay" class='picker' placeholder="" value="每天"/>-->

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                    </div>

                    <div class="card-footer time-hour" style="display: block">
                            <ul class="day_num">
                                <li data-check="0">08</li>
                                <li data-check="0">09</li>
                                <li data-check="0">10</li>
                                <li data-check="0">11</li>
                                <li data-check="0">12</li>
                                <li data-check="0">13</li>
                                <li data-check="0">14</li>
                                <li data-check="0">15</li>
                                <li data-check="0">16</li>
                                <li data-check="0">17</li>
                                <li data-check="0">18</li>
                                <li data-check="0">19</li>
                                <li data-check="0">20</li>
                                <li data-check="0">21</li>
                                <li data-check="0">22</li>
                                <li data-check="0">23</li>
                                <li data-check="0">00</li>
                                <li data-check="0">01</li>
                                <li data-check="0">02</li>
                                <li data-check="0">03</li>
                                <li data-check="0">04</li>
                                <li data-check="0">05</li>
                                <li data-check="0">06</li>
                                <li data-check="0">07</li>
                                <li class="clear"></li>
                            </ul>
                            <div class="item-inner">

                                <div class="item-title-row">

                                    <div class="item-title price">已选广告屏 <span>1</span> 天:  <span>40</span>/天</div>
                                    <div class="item-after each-price" style="margin-left: 0">总价:  <span>80</span>元</div>
                                </div>
                            </div>
                        </div>
                </div>
            </div>
            <div class="total">
                已选广告屏总价： <span class="sum">00</span>元
                <a href="#" class="button button-big button-fill button-warning affrim">确认</a>
            </div>

        </div>
    </div>

</div>


<!-- popup, panel 等放在这里 -->
<div class="">

</div>


<!-- Left Panel with Reveal effect -->
<div class="panel panel-left panel-reveal">

</div>


</body>
<script type='text/javascript' src='http://cdn.bootcss.com/zepto/1.0rc1/zepto.min.js' charset='utf-8'></script>
<script type='text/javascript' src='http://g.alicdn.com/msui/sm/0.6.2/js/sm.min.js' charset='utf-8'></script>
<script type='text/javascript' src='http://g.alicdn.com/msui/sm/0.6.2/js/sm-extend.min.js' charset='utf-8'></script>
<script type="text/javascript" src="http://g.alicdn.com/msui/sm/0.6.2/js/sm-city-picker.min.js" charset="utf-8"></script>
<script type="text/javascript">

//    $(".datetime-picker").each(function () {
//        $(this).datetimePicker({})
//    });
    $(".datetime-picker").datetimePicker({})
$(".datetime-picker2").datetimePicker({})
$(".datetime-picker3").datetimePicker({})

//    每个的价格
    $('.item-media .icon').bind('tap',function () {
        var selector = $(this).attr('data-check');
        if(selector == '0'){
            $(this).attr('data-check',1);
        }else if(selector == '1'){
            $(this).attr('data-check',0);
        }
        var sum = 0,sum1 = 0,sum2 = 0;
        $('.item-media').each(function (i,el) {
            if($(this).find('.icon').attr('data-check')== '1'){
                sum1 += parseInt($(this).parent().prev().find('.item-after span').text());
            }
            if($(this).find('.icon').attr('data-check')== '0'){
                sum2 += parseInt($(this).parent().prev().find('.price span').text());
            }
            sum = sum1 + sum2;
        })
        $('.total .sum').html('￥' + sum);

    })
    $('.each-price').each(function () {

       $(this).find('span').html()
    });
//    总价格
    var eachPrice = 0;
    $('.item-inner .each-price').each(function () {
         eachPrice += parseInt($(this).find('span').text());
    })
    $('.total .sum').html('￥' + eachPrice);
//日期的时间选择
    $(".day_num li").bind('tap',function(){
        var selector2 = $(this).attr('data-check');
        if(selector2 == '0'){
            $(this).attr('data-check',1);
        }else if(selector2 == '1'){
            $(this).attr('data-check',0);
        }
        if( selector2 =="0"){
            $(this).addClass("active");
        }else if(selector2 == '1'){
            $(this).removeClass("active"); //切换选中的按钮高亮状态
        }

    });
//下拉天数
    $(".picker").picker({
        toolbarTemplate: '<header class="bar bar-nav">\
          <button class="button button-link pull-right close-picker">确定</button>\
          <h1 class="title">天数</h1>\
          </header>',
        cols: [
            {
                textAlign: 'center',
                values: ['1天','3天','7天','14天','28天']
            }
        ],
        onOpen:function () {

        },
        onClose:function () {

        }
    });
    //    全局变量
    var retDateDay ,retDates,dayNum,day;
    $('.item-content').find('.dayselect').tap(function () {

        retDates = $(this).parent().parent().parent().find(".date").val();

        if(! retDates){
            $.alert("请选择起始日");
        }else{
            $(this).find('select').empty();
            dayNum = $(this).parent().parent().parent().find(".picker").val();
            day = parseInt(dayNum);
            retDateDay = getAfterDay(retDates,day);
            var str1 = '<option>每天</option>';
            $(this).find('select').append(str1);
            for(var i=0;i<retDateDay.length;i++){
                var nth = retDateDay[i];
                var str = '<option>' + nth + '日</option>';
                $(this).find('select').append(str);
            }
        }
    })



//日期方法
    function getAfterDay(day,amount){
        if(Date.parse(day) != Date.parse(day)){
            return false;
        }
        day =new Date(day);
        var returnDate = [];
        var v = day.valueOf();
        var days = new Date((v+86400000));
        if(amount) {
            var i = 0;
            for(i;i<=amount;i++){
                var number = parseInt(i);
                if (number && number > 0 && !isNaN(number)) {
                    days = new Date((v + 86400000 * (number - 1)));
                    returnDate.push(days.getDate());
                }
            }

        }
        return returnDate;
    }


</script>
</html>